[global]
max_forwards=70
user_agent=Raspberry Pi BPX
default_realm=raspberrypi.local
keep_alive_interval=300
external_media_address=177.149.87.22
external_signaling_address=177.149.87.22
local_net=192.168.0.0/24
alwaysauthreject=yes

; == Transports

[udp_transport]
type=transport
protocol=udp
bind=0.0.0.0
tos=af42
cos=3
allow_reload=yes

[wss_transport]
type=transport
protocol=wss
bind=0.0.0.0:5066
local_net=192.168.0.0/24  ; Substitua pela rede correta
external_media_address=177.149.87.22
external_signaling_address=177.149.87.22
allow_reload=yes

[tcp_transport]
type=transport
protocol=tcp
bind=0.0.0.0
allow_reload=yes

[tls_transport]
type=transport
protocol=tls
bind=0.0.0.0
cert_file=/etc/letsencrypt/live/homologacaotracevia.com.br-0002/fullchain.pem
priv_key_file=/etc/letsencrypt/live/homologacaotracevia.com.br-0002/privkey.pem
cipher=ADH-AES256-SHA,ADH-AES128-SHA
method=tlsv1
allow_reload=yes

; == ACL

[acl]
type=acl
deny=0.0.0.0/0.0.0.0
permit=10.0.0.0/255.0.0.0
permit=172.16.0.0/255.240.0.0
permit=192.168.0.0/255.255.0.0
permit=127.0.0.1
permit=186.220.116.138
; == Templates

[single_aor](!)
max_contacts=1
qualify_frequency=120
remove_existing=yes

[userpass_auth](!)
auth_type=userpass

[attendant_endpoint](!)
moh_suggest=default
context=attendant
inband_progress=no

[basic_endpoint](!)
moh_suggest=default
context=from-extensions
inband_progress=no
rtp_timeout=120
message_context=textmessages
allow_subscribe=yes
subscribe_context=subscriptions
direct_media=no
dtmf_mode=rfc4733
device_state_busy_at=1
disallow=all

[phone_endpoint](!)
allow=ulaw,alaw,g722,gsm,vp9,vp8,h264

[webrtc_endpoint](!)
transport=wss_transport
allow=opus,ulaw,vp9,vp8,h264
webrtc=yes
use_avpf=yes
media_encryption=dtls
dtls_verify=fingerprint
dtls_setup=actpass
ice_support=yes
media_use_received_transport=yes
rtcp_mux=yes
dtls_cert_file=/etc/letsencrypt/live/homologacaotracevia.com.br-0002/fullchain.pem
dtls_private_key=/etc/letsencrypt/live/homologacaotracevia.com.br-0002/privkey.pem
dtls_ca_file=/etc/letsencrypt/live/homologacaotracevia.com.br-0002/chain.pem
force_rport=yes
rewrite_contact=yes
dtls_rekey=0

; == Users

[1001](basic_endpoint,webrtc_endpoint)
type=endpoint
callerid="Ismael teste" <100>
auth=1001
aors=1001

[1001](single_aor)
type=aor
mailboxes=1001@default

[1001](userpass_auth)
type=auth
username=1001
password=1234

[1002](basic_endpoint,webrtc_endpoint)
type=endpoint
callerid="teste 2" <100>
auth=1002
aors=1002
[1002](single_aor)
type=aor
mailboxes=1002@default
[1002](userpass_auth)
type=auth
username=1002
password=1234

[1003](basic_endpoint,webrtc_endpoint)
type=endpoint
callerid="teste 3" <100>
auth=1003
aors=1003
[1003](single_aor)
type=aor
mailboxes=1003@default
[1003](userpass_auth)
type=auth
username=1003
password=1234

[attendant01]
type=endpoint
context=attendant-normal
disallow=all
allow=opus,ulaw,alaw
webrtc=yes
auth=attendant01
aors=attendant01
transport=wss_transport

[attendant01]
type=auth
auth_type=userpass
password=1234
username=attendant01

[attendant01]
type=aor
max_contacts=1

[attendant02]
type=endpoint
context=attendant-normal
disallow=all
allow=opus,ulaw,alaw
webrtc=yes
auth=attendant02
aors=attendant02
transport=wss_transport

[attendant02]
type=auth
auth_type=userpass
password=1234
username=attendant02

[attendant02]
type=aor
max_contacts=1

[attendant03]
type=endpoint
context=attendant-normal
disallow=all
allow=opus,ulaw,alaw
webrtc=yes
auth=attendant03
aors=attendant03
transport=wss_transport

[attendant03]
type=auth
auth_type=userpass
password=1234
username=attendant03

[attendant03]
type=aor
max_contacts=1





[attendant04]
type=endpoint
context=attendant-normal
disallow=all
allow=opus,ulaw,alaw
webrtc=yes
auth=attendant04
aors=attendant04
transport=wss_transport

[attendant04]
type=auth
auth_type=userpass
password=1234
username=attendant04

[attendant04]
type=aor
max_contacts=1


[caller01]
type=endpoint
context=caller
disallow=all
allow=opus,ulaw, alaw
webrtc=yes
auth=caller01
aors=caller01
transport=wss_transport

[caller01]
type=auth
auth_type=userpass
password=1234
username=caller01

[caller01]
type=aor
max_contacts=1

[caller02]
type=endpoint
context=caller
disallow=all
allow=opus,ulaw, alaw
webrtc=yes
auth=caller02
aors=caller02
transport=wss_transport

[caller02]
type=auth
auth_type=userpass
password=1234
username=caller02

[caller02]
type=aor
max_contacts=1

[caller03]
type=endpoint
context=caller
disallow=all
allow=opus,ulaw, alaw
webrtc=yes
auth=caller03
aors=caller03
transport=wss_transport

[caller03]
type=auth
auth_type=userpass
password=1234
username=caller03

[caller03]
type=aor
max_contacts=1


[caller04]
type=endpoint
context=caller
disallow=all
allow=opus,ulaw, alaw
webrtc=yes
auth=caller04
aors=caller04
transport=wss_transport

[caller04]
type=auth
auth_type=userpass
password=1234
username=caller04

[caller04]
type=aor
max_contacts=1

[caller05]
type=endpoint
context=caller
disallow=all
allow=opus,ulaw, alaw
webrtc=yes
auth=caller05
aors=caller05
transport=wss_transport

[caller05]
type=auth
auth_type=userpass
password=1234
username=caller05

[caller05]
type=aor
max_contacts=1

[caller06]
type=endpoint
context=caller
disallow=all
allow=opus,ulaw, alaw
webrtc=yes
auth=caller06
aors=caller06
transport=wss_transport

[caller06]
type=auth
auth_type=userpass
password=1234
username=caller06

[caller06]
type=aor
max_contacts=1

