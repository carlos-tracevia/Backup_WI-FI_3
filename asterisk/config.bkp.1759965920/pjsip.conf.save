[global]
max_forwards=70
user_agent=Raspberry Pi BPX
default_realm=raspberrypi.local
keep_alive_interval=300
;external_media_address=177.149.87.22
;external_signaling_address=177.149.87.22
local_net=192.168.1.0/24
localnet=192.168.1.0/255.255.255.0
alwaysauthreject=yes
;nat=no
;directmedia=yes     ; permite RTP direto entre os peers
canreinvite=yes

; == Transports

[udp_transport]
type=transport
protocol=udp
bind=0.0.0.0
tos=af42
cos=3
allow_reload=yes

[wss_transport]
type=transport
protocol=wss
bind=0.0.0.0:5066
local_net=192.168.0.0/24  ; Substitua pela rede correta
external_media_address=177.149.87.22
external_signaling_address=177.149.87.22
allow_reload=yes

;[tcp_transport]
;type=transport
;protocol=tcp
;bind=0.0.0.0
;allow_reload=yes

[tls_transport]
type=transport
protocol=tls
bind=0.0.0.0
cert_file=/etc/letsencrypt/live/homologacaotracevia.com.br-0002/fullchain.pem
priv_key_file=/etc/letsencrypt/live/homologacaotracevia.com.br-0002/privkey.pem
cipher=ADH-AES256-SHA,ADH-AES128-SHA
method=tlsv1
allow_reload=yes

; == ACL

[acl]
type=acl
deny=0.0.0.0/0.0.0.0
permit=10.0.0.0/255.0.0.0
permit=172.16.0.0/255.240.0.0
permit=192.168.0.0/255.255.0.0
permit=127.0.0.1
permit=186.220.116.138
; == Templates

[single_aor](!)
max_contacts=1
qualify_frequency=120
remove_existing=yes

[userpass_auth](!)
auth_type=userpass

[attendant_endpoint](!)
moh_suggest=default
context=attendant
inband_progress=no

[basic_endpoint](!)
moh_suggest=default
context=from-extensions
inband_progress=no
rtp_timeout=120
message_context=textmessages
allow_subscribe=yes
subscribe_context=subscriptions
direct_media=no
dtmf_mode=rfc4733
device_state_busy_at=1
disallow=all

[phone_endpoint](!)
allow=ulaw,alaw,g722,gsm,vp9,vp8,h264

[webrtc_endpoint](!)
transport=wss_transport
allow=opus,ulaw,vp9,vp8,h264
webrtc=yes
use_avpf=yes
media_encryption=dtls
dtls_verify=fingerprint
dtls_setup=actpass
ice_support=yes
media_use_received_transport=yes
rtcp_mux=yes
dtls_cert_file=/etc/letsencrypt/live/homologacaotracevia.com.br-0002/fullchain.pem
dtls_private_key=/etc/letsencrypt/live/homologacaotracevia.com.br-0002/privkey.pem
dtls_ca_file=/etc/letsencrypt/live/homologacaotracevia.com.br-0002/chain.pem
force_rport=yes
rewrite_contact=yes
dtls_rekey=0

; == Users

[1001](basic_endpoint,webrtc_endpoint)
type=endpoint
callerid="Ismael teste" <100>
auth=1001
aors=1001

[1001](single_aor)
type=aor
mailboxes=1001@default

[1001](userpass_auth)
type=auth
username=1001
password=1234

[1002](basic_endpoint,webrtc_endpoint)
type=endpoint
callerid="teste 2" <100>
auth=1002
aors=1002
[1002](single_aor)
type=aor
mailboxes=1002@default
[1002](userpass_auth)
type=auth
username=1002
password=1234

[1003](basic_endpoint,webrtc_endpoint)
type=endpoint
callerid="teste 3" <100>
auth=1003
aors=1003
[1003](single_aor)
type=aor
mailboxes=1003@default
[1003](userpass_auth)
type=auth
username=1003
password=1234

[401]
type=endpoint
context=attendant-normal
disallow=all
allow=opus,ulaw,alaw
webrtc=yes
auth=401
aors=401
transport=wss_transport

[401]
type=auth
auth_type=userpass
password=1234
username=401

[401]
type=aor
max_contacts=1

[402]
type=endpoint
context=attendant-normal
disallow=all
allow=opus,ulaw,alaw
webrtc=yes
auth=402
aors=402
transport=wss_transport

[402]
type=auth
auth_type=userpass
password=1234
username=402

[402]
type=aor
max_contacts=1

[403]
type=endpoint
context=attendant-normal
disallow=all
allow=opus,ulaw,alaw
webrtc=yes
auth=403
aors=403
transport=wss_transport

[403]
type=auth
auth_type=userpass
password=1234
username=403

[403]
type=aor
max_contacts=1

[404]
type=endpoint
context=attendant-normal
disallow=all
allow=opus,ulaw,alaw
webrtc=yes
auth=404
aors=404
transport=wss_transport

[404]
type=auth
auth_type=userpass
password=1234
username=404

[404]
type=aor
max_contacts=1

[100]
type=endpoint
context=caller
disallow=all
allow=opus,ulaw, alaw
webrtc=yes
auth=100
aors=100
transport=wss_transport

[100]
type=auth
auth_type=userpass
password=1234
username=100

[100]
type=aor
max_contacts=1

[101]
type=endpoint
context=caller
disallow=all
allow=opus,ulaw, alaw
webrtc=yes
auth=101
aors=101
transport=wss_transport

[101]
type=auth
auth_type=userpass
password=1234
username=101

[101]
type=aor
max_contacts=1
qualify_frequency=15
minimun_expiration=1

[102]
type=endpoint
context=caller
disallow=all
allow=opus,ulaw, alaw
webrtc=yes
auth=102
aors=102
transport=wss_transport

[102]
type=auth
auth_type=userpass
password=1234
username=102

[102]
type=aor
max_contacts=1


[103]
type=endpoint
context=caller
disallow=all
allow=opus,ulaw, alaw
webrtc=yes
auth=103
aors=103
transport=wss_transport

[103]
type=auth
auth_type=userpass
password=1234
username=103

[103]
type=aor
max_contacts=1

[104]
type=endpoint
context=caller
disallow=all
allow=opus,ulaw, alaw
webrtc=yes
auth=104
aors=104
transport=wss_transport

[104]
type=auth
auth_type=userpass
password=1234
username=104

[104]
type=aor
max_contacts=1

[105]
type=endpoint
context=caller
disallow=all
allow=opus,ulaw, alaw
webrtc=yes
auth=105
aors=105
transport=wss_transport

[105]
type=auth
auth_type=userpass
password=1234
username=105


[105]
type=aor
max_contacts=1
minimun_expiration=1
